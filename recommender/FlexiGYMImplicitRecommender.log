C:\Users\sande\PycharmProjects\flexigym\venv\Scripts\python.exe C:/Users/sande/PycharmProjects/flexigym/recommender/FlexiGYMImplicitRecommender1.py
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
+---------+---------+----------------+------+
|   userId|packageId|      event_type|rating|
+---------+---------+----------------+------+
|593124909|       18|            view|     2|
|253962882|       36|            view|     1|
|530095744|       38|remove_from_cart|     2|
|597544157|       38|            cart|     1|
|503304249|       38|            view|     3|
|599020508|       38|        purchase|     1|
|587381425|       44|            view|     1|
|544625721|       47|            cart|     1|
|414166723|       47|            view|     1|
|498387197|       10|            view|     1|
|600067590|       18|            cart|     1|
|599842049|       18|remove_from_cart|     1|
|596465146|       38|            cart|     2|
|434651191|       39|            cart|     1|
|592912415|       44|            view|     1|
|597846757|       44|            view|     1|
|510139418|       44|            view|     1|
|599247498|       44|            cart|     1|
|562347361|       44|            view|     1|
|546203327|       15|            view|     1|
+---------+---------+----------------+------+
only showing top 20 rows

root
 |-- userId: integer (nullable = true)
 |-- packageId: integer (nullable = true)
 |-- event_type: string (nullable = true)
 |-- rating: long (nullable = false)

The ratings dataframe is  95.88% empty.
+---------+-----+
|   userId|count|
+---------+-----+
|550031373|    6|
|549939130|    6|
|574970805|    6|
|589670123|    5|
|599889882|    5|
|599717201|    5|
|597579816|    5|
|540406656|    4|
|596487565|    4|
|598453686|    4|
|596711597|    4|
|553783263|    4|
|597635121|    4|
|598683368|    4|
|598378345|    4|
|591473746|    4|
|527846171|    4|
|597876331|    4|
|469666975|    4|
|590498263|    4|
+---------+-----+
only showing top 20 rows

+---------+-----+
|packageId|count|
+---------+-----+
|       38|  599|
|       28|  212|
|       18|  208|
|       47|  193|
|       44|  190|
|       11|  141|
|       15|  121|
|        7|   83|
|       16|   64|
|       39|   61|
|       32|   59|
|       10|   53|
|       43|   47|
|       30|   47|
|       48|   32|
|       50|   28|
|       25|   26|
|       17|   26|
|        4|   19|
|        5|   18|
+---------+-----+
only showing top 20 rows

Num models to be tested:  1
CrossValidator_a3edd7e5c538
21/05/01 01:51:18 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
21/05/01 01:51:18 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
<class 'pyspark.ml.recommendation.ALSModel'>
Rank:	 100
MaxIter:  1
RegParam: 0.1
RMSE value is 1.255706853877937
+---------+---------+----------------+------+----------+
|   userId|packageId|      event_type|rating|prediction|
+---------+---------+----------------+------+----------+
|596904549|       31|remove_from_cart|     1| 0.5708208|
|475629102|       28|            cart|     1| 0.7346567|
|550664653|       28|            cart|     1| 0.7346567|
|419857381|       28|            cart|     1| 0.7346567|
|419857381|       28|            view|     1| 0.7346567|
|589457916|       28|remove_from_cart|     1| 0.7346567|
|596813204|       28|            view|     1| 1.0056912|
|543934944|       28|remove_from_cart|     2| 0.7346567|
|535346162|       28|            view|     1|0.09489995|
|354493997|       28|        purchase|     1| 0.7346567|
|534147472|       28|            cart|     3| 1.0020618|
|555150208|       28|            view|     2| 0.7346567|
|469374083|       28|remove_from_cart|     1|0.39080563|
|595522093|       28|remove_from_cart|     1| 0.7346567|
|531988416|       28|remove_from_cart|     2| 0.7346567|
|597635121|       28|            view|     3| 1.0037869|
|597635121|       28|remove_from_cart|     2| 1.0037869|
|597692116|       28|            view|     1| 0.7346567|
|558574303|       28|remove_from_cart|     2| 0.7346567|
|492766675|       28|        purchase|     1| 0.7346567|
+---------+---------+----------------+------+----------+
only showing top 20 rows

+---------+--------------------+
|   userId|     recommendations|
+---------+--------------------+
|523763909|[[38, 0.62481695]...|
|429666020|[[47, 0.95648247]...|
|596760502|[[38, 1.0215448],...|
|429753735|[[10, 0.5819636],...|
|461799286|[[18, 0.81738997]...|
|560915687|[[25, 0.5450621],...|
|417219658|[[45, 0.42982852]...|
|592982771|[[11, 0.58693403]...|
|475629102|[[28, 0.7346567],...|
|586457183|[[28, 0.8470341],...|
+---------+--------------------+

+---------+---------+----------+
|   userId|packageId|    rating|
+---------+---------+----------+
|523763909|       38|0.62481695|
|523763909|       39|0.24556081|
|523763909|       43|0.14728233|
|523763909|       18|  0.147275|
|523763909|        9|0.14589152|
|523763909|       44|0.13585205|
|523763909|       24|0.12783484|
|523763909|       30|0.12567292|
|523763909|        5|0.10749845|
|523763909|       32|0.10565228|
+---------+---------+----------+

category of recommended items for n_recommendations_550031373
+---------+---------+----------+--------------+--------------------+----------------+-------------------+---------+
|packageId|   userId|    rating|         title|          event_time|      event_type|         categoryId|   userId|
+---------+---------+----------+--------------+--------------------+----------------+-------------------+---------+
|       47|550031373| 0.9251238|Climb Coaching|2020-01-03 19:17:...|remove_from_cart|1487580005092295511|550031373|
|       47|550031373| 0.9251238|Climb Coaching|2020-01-03 19:17:...|remove_from_cart|1487580005092295511|550031373|
|       47|550031373| 0.9251238|Climb Coaching|2020-01-03 18:05:...|            cart|1487580005092295511|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-15 10:59:...|remove_from_cart|1487580007550157767|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-15 10:59:...|remove_from_cart|1487580007550157767|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-15 05:51:...|            cart|1487580007550157767|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-11 18:09:...|remove_from_cart|1487580007550157767|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-11 18:09:...|remove_from_cart|1487580007550157767|550031373|
|       30|550031373|0.73252904|Birthday Party|2020-01-11 17:30:...|            cart|1487580007550157767|550031373|
|       11|550031373| 0.5601151|      Aerotone|2020-01-15 05:55:...|            cart|1487580010628776014|550031373|
|        6|550031373|0.36329928|  Adult + Baby|2020-01-14 20:02:...|            cart|1487580011383750769|550031373|
+---------+---------+----------+--------------+--------------------+----------------+-------------------+---------+

category of original score items before recommendation for 550031373
+---------+--------------------+----------------+-------------------+---------+--------------+
|packageId|          event_time|      event_type|         categoryId|   userId|         title|
+---------+--------------------+----------------+-------------------+---------+--------------+
|        6|2020-01-14 20:02:...|            cart|1487580011383750769|550031373|  Adult + Baby|
|       11|2020-01-15 05:55:...|            cart|1487580010628776014|550031373|      Aerotone|
|       30|2020-01-11 17:30:...|            cart|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-11 18:09:...|remove_from_cart|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-11 18:09:...|remove_from_cart|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 05:51:...|            cart|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 10:59:...|remove_from_cart|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 10:59:...|remove_from_cart|1487580007550157767|550031373|Birthday Party|
|       47|2020-01-03 18:05:...|            cart|1487580005092295511|550031373|Climb Coaching|
|       47|2020-01-03 19:17:...|remove_from_cart|1487580005092295511|550031373|Climb Coaching|
|       47|2020-01-03 19:17:...|remove_from_cart|1487580005092295511|550031373|Climb Coaching|
+---------+--------------------+----------------+-------------------+---------+--------------+

[Stage 411:>                                                       (0 + 8) / 10]21/05/01 01:52:40 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/05/01 01:52:40 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 84.47% for 8 writers
21/05/01 01:52:40 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers

Process finished with exit code 0

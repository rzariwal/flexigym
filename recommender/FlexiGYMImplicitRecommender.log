C:\Users\sande\PycharmProjects\flexigym\venv\Scripts\python.exe C:/Users/sande/PycharmProjects/flexigym/recommender/FlexiGYMImplicitRecommender.py
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
+------+---------+------+----------+
|userId|packageId|rating| Timestamp|
+------+---------+------+----------+
|     2|       49|   4.0|1445714885|
|     2|      162|   5.0|1445714851|
|     4|       21|   4.0| 964622830|
|     4|       46|   4.0| 986934498|
|    12|       38|   5.0|1247263428|
|    15|       10|   2.0|1510578088|
|    16|       35|   3.0|1377476611|
|    17|       36|   5.0|1305696756|
|    17|       47|   3.5|1307262260|
|    19|        7|   3.0| 965712068|
|    22|       35|   3.5|1268726085|
|    22|       97|   2.0|1268727389|
|    23|       10|   3.5|1107162895|
|    29|      103|   5.0|1362016752|
|    32|       20|   3.0| 856736652|
|    33|       37|   4.0| 939718916|
|    34|       25|   3.0|1162048144|
|    42|       34|   3.0| 996259605|
|    47|       77|   3.0|1496205365|
|    47|      119|   3.5|1496206905|
+------+---------+------+----------+
only showing top 20 rows

root
 |-- userId: integer (nullable = true)
 |-- packageId: integer (nullable = true)
 |-- rating: double (nullable = true)
 |-- Timestamp: integer (nullable = true)

+------+---------+------+
|userId|packageId|rating|
+------+---------+------+
|     2|       49|   4.0|
|     2|      162|   5.0|
|     4|       21|   4.0|
|     4|       46|   4.0|
|    12|       38|   5.0|
|    15|       10|   2.0|
|    16|       35|   3.0|
|    17|       36|   5.0|
|    17|       47|   3.5|
|    19|        7|   3.0|
|    22|       35|   3.5|
|    22|       97|   2.0|
|    23|       10|   3.5|
|    29|      103|   5.0|
|    32|       20|   3.0|
|    33|       37|   4.0|
|    34|       25|   3.0|
|    42|       34|   3.0|
|    47|       77|   3.0|
|    47|      119|   3.5|
+------+---------+------+
only showing top 20 rows

The ratings dataframe is  71.76% empty.
+------+-----+
|userId|count|
+------+-----+
|   599|  176|
|   380|  174|
|   448|  174|
|   610|  173|
|   318|  171|
|   414|  171|
|   534|  169|
|   249|  167|
|   298|  162|
|   105|  161|
|    68|  161|
|   462|  160|
|   305|  160|
|   111|  158|
|   525|  156|
|    18|  154|
|    89|  153|
|   560|  152|
|   483|  150|
|   177|  149|
+------+-----+
only showing top 20 rows

+---------+-----+
|packageId|count|
+---------+-----+
|        1|  521|
|        6|  520|
|       10|  513|
|        5|  506|
|       17|  445|
|        3|  414|
|       18|  397|
|       12|  396|
|        9|  395|
|        2|  391|
|        8|  383|
|       36|  357|
|        7|  349|
|       11|  345|
|       15|  341|
|        4|  335|
|       16|  334|
|       24|  325|
|       32|  315|
|       41|  314|
+---------+-----+
only showing top 20 rows

Num models to be tested:  8
CrossValidator_64234b218844
21/04/30 13:57:12 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
21/04/30 13:57:12 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
<class 'pyspark.ml.recommendation.ALSModel'>
Rank:	 8
MaxIter:  5
RegParam: 0.01
RMSE value is 3.042913883487769
+------+---------+------+----------+
|userId|packageId|rating|prediction|
+------+---------+------+----------+
|   596|      148|   3.5|0.83498347|
|   599|      148|   3.0|0.77064943|
|   560|      148|   3.5|0.70121443|
|   318|      148|   4.0|0.79863244|
|   448|      148|   3.0| 0.6628699|
|    50|      148|   2.5| 0.7945511|
|   249|      148|   3.0|0.83474916|
|   125|      148|   4.5|0.80824685|
|    21|      148|   1.5| 0.7120951|
|   534|      148|   3.5|0.74111015|
|   105|      148|   4.0|0.84806216|
|   106|      148|   5.0|0.21329488|
|   525|      148|   4.0|0.78883255|
|   516|       31|   3.0|0.13261509|
|   362|       31|   5.0|0.42196977|
|    34|       31|   5.0|0.43937877|
|    28|       31|   2.5|0.78439754|
|   183|       31|   2.0| 0.7562457|
|   384|       31|   3.0| 0.6874067|
|   271|       31|   3.5| 0.5837248|
+------+---------+------+----------+
only showing top 20 rows

+------+--------------------+
|userId|     recommendations|
+------+--------------------+
|   471|[[6, 0.83261603],...|
|   463|[[8, 0.772986], [...|
|   496|[[17, 1.0236863],...|
|   148|[[135, 0.9159837]...|
|   540|[[17, 0.9260473],...|
|   392|[[17, 0.85554016]...|
|   243|[[5, 0.8486481], ...|
|    31|[[5, 1.021065], [...|
|   516|[[17, 0.74406767]...|
|   580|[[71, 0.97278655]...|
+------+--------------------+

+------+---------+----------+
|userId|packageId|    rating|
+------+---------+----------+
|   471|        6|0.83261603|
|   471|      135| 0.8204651|
|   471|       65|0.74661845|
|   471|      128| 0.7374614|
|   471|        1| 0.7235166|
|   471|      133|0.67946506|
|   471|       76| 0.6637418|
|   471|       90|0.65822935|
|   471|      147| 0.6571609|
|   471|      115|0.64777094|
+------+---------+----------+

+---------+------+----------+--------------------+
|packageId|userId|    rating|               title|
+---------+------+----------+--------------------+
|       17|   100| 1.0542855|  Athletics Coaching|
|       18|   100|  1.022272|           Badminton|
|        1|   100|0.98933315|      Activator Camp|
|       16|   100|0.98228204|           Athletics|
|        8|   100|  0.975612|Adult Tennis Coac...|
|        6|   100| 0.9638085|        Adult + Baby|
|        9|   100|0.95915264|  Adult Wet Coaching|
|       37|   100| 0.9521791|            Bodystep|
|        5|   100|0.91456515|Add Supp Needs Pr...|
|       22|   100|0.90514684|          Basketball|
+---------+------+----------+--------------------+

+---------+------+------+--------------------+
|packageId|userId|rating|               title|
+---------+------+------+--------------------+
|       55|   100|   5.0|       Dive Coaching|
|       34|   100|   5.0|          Bodycombat|
|       27|   100|   5.0|         Beginners 2|
|       73|   100|   5.0|             General|
|       24|   100|   4.5|           Beginners|
|       96|   100|   4.5|  Individual Lessons|
|        1|   100|   4.5|      Activator Camp|
|       12|   100|   4.5|   American Football|
|       58|   100|   4.5|Education Dry Coa...|
|       57|   100|   4.5|  Education Coaching|
+---------+------+------+--------------------+

21/04/30 14:02:33 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/04/30 14:02:33 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 84.47% for 8 writers
[Stage 6321:>                                                      (0 + 8) / 10]21/04/30 14:02:34 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers

Process finished with exit code 0

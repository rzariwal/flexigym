C:\Users\sande\PycharmProjects\flexigym\venv\Scripts\python.exe C:/Users/sande/PycharmProjects/flexigym/recommender/FlexiGYMImplicitRecommender.py
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
+---------+---------+----------+------+
|   userId|packageId|event_type|rating|
+---------+---------+----------+------+
|461581124|       18|      view|     1|
|593124909|       18|      view|     2|
|423454632|       28|  purchase|     1|
|253962882|       36|      view|     1|
|503304249|       38|      view|     5|
|599020508|       38|  purchase|     3|
|587381425|       44|      view|     1|
|414166723|       47|      view|     1|
|498387197|       10|      view|     1|
|592912415|       44|      view|     1|
|597846757|       44|      view|     1|
|510139418|       44|      view|     3|
|562347361|       44|      view|     1|
|546203327|       15|      view|     1|
|553691665|       16|      view|     1|
|559120805|       18|  purchase|     2|
|598729354|       28|      view|     2|
|519213602|       38|      view|     5|
|596091041|       38|  purchase|     1|
|544543789|       38|      view|     3|
+---------+---------+----------+------+
only showing top 20 rows

root
 |-- userId: integer (nullable = true)
 |-- packageId: integer (nullable = true)
 |-- event_type: string (nullable = true)
 |-- rating: long (nullable = false)

The ratings dataframe is  96.39% empty.
+---------+-----+
|   userId|count|
+---------+-----+
|550031373|    6|
|599889882|    5|
|596033551|    4|
|568233448|    4|
|466572521|    4|
|567559848|    4|
|598706384|    4|
|574970805|    4|
|549939130|    4|
|589670123|    4|
|596711597|    4|
|599717201|    4|
|597579816|    4|
|597876331|    3|
|553783263|    3|
|579701116|    3|
|590498263|    3|
|597021161|    3|
|528031345|    3|
|596409220|    3|
+---------+-----+
only showing top 20 rows

+---------+-----+
|packageId|count|
+---------+-----+
|       38|  493|
|       18|  185|
|       28|  182|
|       44|  178|
|       47|  164|
|       11|  125|
|       15|  115|
|        7|   78|
|       16|   61|
|       39|   55|
|       32|   52|
|       10|   46|
|       30|   42|
|       43|   41|
|       48|   27|
|       25|   24|
|       50|   23|
|       17|   23|
|        5|   17|
|        4|   17|
+---------+-----+
only showing top 20 rows

Num models to be tested:  1
CrossValidator_68ac4a7a8b52
21/05/01 02:50:16 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
21/05/01 02:50:16 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
<class 'pyspark.ml.recommendation.ALSModel'>
Rank:	 100
MaxIter:  1
RegParam: 0.1
RMSE value is 1.744789818410874
+---------+---------+----------+------+----------+
|   userId|packageId|event_type|rating|prediction|
+---------+---------+----------+------+----------+
|596813204|       28|  purchase|     1|0.73882264|
|543934944|       28|  purchase|     1|0.73882264|
|555150208|       28|  purchase|     1|0.73882264|
|469374083|       28|      view|     1|0.16402884|
|595522093|       28|  purchase|     1|0.65348494|
|549199116|       28|  purchase|     1| 0.7904335|
|531988416|       28|      view|     2|0.65348494|
|539685512|       28|  purchase|     1|0.65348494|
|415353362|       28|  purchase|     2|0.65348494|
|471800662|       28|      view|     4|0.73882264|
|562917585|       28|      view|     1|0.73882264|
|597635121|       28|  purchase|     4| 0.8497965|
|528031345|       28|  purchase|     1| 0.7908985|
|595458066|       28|  purchase|     1|0.65348494|
|587022750|       28|      view|     3|0.65348494|
|561933277|       28|      view|     1|0.73882264|
|352280072|       28|  purchase|     3| 0.7904335|
|386661905|       28|      view|     2|0.73882264|
|408644408|       28|  purchase|     1|0.73882264|
|598729354|       28|      view|     2|0.73882264|
+---------+---------+----------+------+----------+
only showing top 20 rows

+---------+--------------------+
|   userId|     recommendations|
+---------+--------------------+
|554134661|[[28, 0.65348494]...|
|315163722|[[38, 0.6893954],...|
|547896223|[[38, 0.9776849],...|
|530126676|[[18, 0.61597794]...|
|592702558|[[6, 0.36566123],...|
|523763909|[[38, 0.6893954],...|
|429666020|[[47, 0.87878704]...|
|596760502|[[38, 0.9813346],...|
|578826194|[[38, 0.6893954],...|
|429753735|[[10, 0.535224], ...|
+---------+--------------------+

+---------+---------+----------+
|   userId|packageId|    rating|
+---------+---------+----------+
|554134661|       28|0.65348494|
|554134661|       11|   0.15474|
|554134661|       18|0.15399025|
|554134661|       47| 0.1496272|
|554134661|       44|0.14891188|
|554134661|        7|0.14806248|
|554134661|       39|0.14731023|
|554134661|       43|0.13534577|
|554134661|       48| 0.1322326|
|554134661|       31|0.12206342|
+---------+---------+----------+

category of recommended items for n_recommendations_550031373
+---------+---------+----------+--------------+--------------------+----------+-------------------+---------+
|packageId|   userId|    rating|         title|          event_time|event_type|         categoryId|   userId|
+---------+---------+----------+--------------+--------------------+----------+-------------------+---------+
|       47|550031373| 0.9784331|Climb Coaching|2020-01-03 19:17:...|      view|1487580005092295511|550031373|
|       47|550031373| 0.9784331|Climb Coaching|2020-01-03 19:17:...|      view|1487580005092295511|550031373|
|       47|550031373| 0.9784331|Climb Coaching|2020-01-03 18:05:...|  purchase|1487580005092295511|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-15 10:59:...|      view|1487580007550157767|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-15 10:59:...|      view|1487580007550157767|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-15 05:51:...|  purchase|1487580007550157767|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-11 18:09:...|      view|1487580007550157767|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-11 18:09:...|      view|1487580007550157767|550031373|
|       30|550031373| 0.9480652|Birthday Party|2020-01-11 17:30:...|  purchase|1487580007550157767|550031373|
|       11|550031373|0.60457385|      Aerotone|2020-01-15 05:55:...|  purchase|1487580010628776014|550031373|
+---------+---------+----------+--------------+--------------------+----------+-------------------+---------+

category of original score items before recommendation for 550031373
+---------+--------------------+----------+-------------------+---------+--------------+
|packageId|          event_time|event_type|         categoryId|   userId|         title|
+---------+--------------------+----------+-------------------+---------+--------------+
|        6|2020-01-14 20:02:...|  purchase|1487580011383750769|550031373|  Adult + Baby|
|       11|2020-01-15 05:55:...|  purchase|1487580010628776014|550031373|      Aerotone|
|       30|2020-01-11 17:30:...|  purchase|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-11 18:09:...|      view|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-11 18:09:...|      view|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 05:51:...|  purchase|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 10:59:...|      view|1487580007550157767|550031373|Birthday Party|
|       30|2020-01-15 10:59:...|      view|1487580007550157767|550031373|Birthday Party|
|       47|2020-01-03 18:05:...|  purchase|1487580005092295511|550031373|Climb Coaching|
|       47|2020-01-03 19:17:...|      view|1487580005092295511|550031373|Climb Coaching|
|       47|2020-01-03 19:17:...|      view|1487580005092295511|550031373|Climb Coaching|
+---------+--------------------+----------+-------------------+---------+--------------+

21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 84.47% for 8 writers
[Stage 411:>                                                       (0 + 8) / 10]21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 84.47% for 8 writers
21/05/01 02:51:36 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers

Process finished with exit code 0

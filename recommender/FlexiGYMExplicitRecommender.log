C:\Users\sande\PycharmProjects\flexigym\venv\Scripts\python.exe C:/Users/sande/PycharmProjects/flexigym/recommender/FlexiGYMExplicitRecommender.py
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
+------+---------+------+----------+
|userId|packageId|rating| Timestamp|
+------+---------+------+----------+
|     2|       49|   4.0|1445714885|
|     2|      162|   5.0|1445714851|
|     4|       21|   4.0| 964622830|
|     4|       46|   4.0| 986934498|
|    12|       38|   5.0|1247263428|
|    15|       10|   2.0|1510578088|
|    16|       35|   3.0|1377476611|
|    17|       36|   5.0|1305696756|
|    17|       47|   3.5|1307262260|
|    19|        7|   3.0| 965712068|
|    22|       35|   3.5|1268726085|
|    22|       97|   2.0|1268727389|
|    23|       10|   3.5|1107162895|
|    29|      103|   5.0|1362016752|
|    32|       20|   3.0| 856736652|
|    33|       37|   4.0| 939718916|
|    34|       25|   3.0|1162048144|
|    42|       34|   3.0| 996259605|
|    47|       77|   3.0|1496205365|
|    47|      119|   3.5|1496206905|
+------+---------+------+----------+
only showing top 20 rows

root
 |-- userId: integer (nullable = true)
 |-- packageId: integer (nullable = true)
 |-- rating: double (nullable = true)
 |-- Timestamp: integer (nullable = true)

+------+---------+------+
|userId|packageId|rating|
+------+---------+------+
|     2|       49|   4.0|
|     2|      162|   5.0|
|     4|       21|   4.0|
|     4|       46|   4.0|
|    12|       38|   5.0|
|    15|       10|   2.0|
|    16|       35|   3.0|
|    17|       36|   5.0|
|    17|       47|   3.5|
|    19|        7|   3.0|
|    22|       35|   3.5|
|    22|       97|   2.0|
|    23|       10|   3.5|
|    29|      103|   5.0|
|    32|       20|   3.0|
|    33|       37|   4.0|
|    34|       25|   3.0|
|    42|       34|   3.0|
|    47|       77|   3.0|
|    47|      119|   3.5|
+------+---------+------+
only showing top 20 rows

The ratings dataframe is  71.76% empty.
+------+-----+
|userId|count|
+------+-----+
|   599|  176|
|   448|  174|
|   380|  174|
|   610|  173|
|   318|  171|
|   414|  171|
|   534|  169|
|   249|  167|
|   298|  162|
|    68|  161|
|   105|  161|
|   305|  160|
|   462|  160|
|   111|  158|
|   525|  156|
|    18|  154|
|    89|  153|
|   560|  152|
|   483|  150|
|   561|  149|
+------+-----+
only showing top 20 rows

+---------+-----+
|packageId|count|
+---------+-----+
|        1|  521|
|        6|  520|
|       10|  513|
|        5|  506|
|       17|  445|
|        3|  414|
|       18|  397|
|       12|  396|
|        9|  395|
|        2|  391|
|        8|  383|
|       36|  357|
|        7|  349|
|       11|  345|
|       15|  341|
|        4|  335|
|       16|  334|
|       24|  325|
|       32|  315|
|       41|  314|
+---------+-----+
only showing top 20 rows

Num models to be tested:  16
CrossValidator_acfbee0e7c2c
21/04/30 11:58:17 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
21/04/30 11:58:17 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
<class 'pyspark.ml.recommendation.ALSModel'>
Rank:	 150
MaxIter:  10
RegParam: 0.15
RMSE value is 0.951358923512882
+------+---------+------+----------+
|userId|packageId|rating|prediction|
+------+---------+------+----------+
|   111|      148|   2.0|  3.348967|
|   509|      148|   3.5| 3.2596376|
|   249|      148|   3.0| 3.5110095|
|    62|      148|   4.0|  3.772792|
|   153|      148|   3.5| 2.2772052|
|   392|       31|   4.0| 2.3128402|
|   322|       31|   3.5|  3.514343|
|   593|       31|   3.0| 3.0321536|
|   412|       31|   3.0| 3.6248121|
|   577|       31|   2.0| 3.3953478|
|    91|       31|   3.0| 3.2445433|
|   409|       31|   4.0| 3.7538319|
|   330|       31|   4.0| 3.7352412|
|   224|       31|   5.0|  4.181041|
|   305|       31|   5.0| 3.7040083|
|   473|       31|   2.5| 3.3352976|
|   603|       31|   3.0| 3.0687673|
|   474|       31|   3.5| 3.7430258|
|   308|       31|   4.5| 2.6928406|
|   479|       31|   5.0| 3.0439136|
+------+---------+------+----------+
only showing top 20 rows

+------+--------------------+
|userId|     recommendations|
+------+--------------------+
|   471|[[165, 4.1466465]...|
|   463|[[17, 4.039906], ...|
|   496|[[93, 3.6570103],...|
|   148|[[93, 4.064513], ...|
|   540|[[41, 4.2014756],...|
|   392|[[45, 2.8218136],...|
|   243|[[10, 4.409653], ...|
|    31|[[18, 4.3828573],...|
|   516|[[93, 3.8500035],...|
|   580|[[58, 3.742004], ...|
+------+--------------------+

+------+---------+---------+
|userId|packageId|   rating|
+------+---------+---------+
|   471|      165|4.1466465|
|   471|      135|  4.10244|
|   471|      166|4.0962825|
|   471|      100|4.0723143|
|   471|        9| 4.031087|
|   471|      173| 4.029274|
|   471|      143|4.0171967|
|   471|       44|3.9969156|
|   471|       17|3.9768505|
|   471|        1| 3.976077|
+------+---------+---------+

+---------+------+---------+--------------------+
|packageId|userId|   rating|               title|
+---------+------+---------+--------------------+
|       93|   100|4.3809557|       Improvers 1:4|
|       17|   100|4.2744184|  Athletics Coaching|
|      101|   100| 4.266036|       Judo Coaching|
|      100|   100| 4.263665|     Jogging Network|
|      173|   100|4.2527122|    X-Press Work Out|
|      176|   100|4.2109046|Z1 Preparation + ...|
|      128|   100|4.2101116|         Pool Â Based|
|       18|   100| 4.208436|           Badminton|
|       58|   100| 4.199783|Education Dry Coa...|
|       41|   100|4.1941934|           Boxercise|
+---------+------+---------+--------------------+

+---------+------+------+--------------------+
|packageId|userId|rating|               title|
+---------+------+------+--------------------+
|       55|   100|   5.0|       Dive Coaching|
|       34|   100|   5.0|          Bodycombat|
|       27|   100|   5.0|         Beginners 2|
|       73|   100|   5.0|             General|
|       24|   100|   4.5|           Beginners|
|       96|   100|   4.5|  Individual Lessons|
|        1|   100|   4.5|      Activator Camp|
|       12|   100|   4.5|   American Football|
|       58|   100|   4.5|Education Dry Coa...|
|       57|   100|   4.5|  Education Coaching|
+---------+------+------+--------------------+

21/04/30 12:13:04 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers
21/04/30 12:13:04 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 84.47% for 8 writers
[Stage 7259:>                                                      (0 + 8) / 10]21/04/30 12:13:08 WARN MemoryManager: Total allocation exceeds 95.00% (906,992,014 bytes) of heap memory
Scaling row group sizes to 96.54% for 7 writers

Process finished with exit code 0
